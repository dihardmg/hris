### =====================================================
### HRIS REST API - Comprehensive Testing Suite
### =====================================================
### For use with VS Code REST Client extension
### Install: humao.rest-client
### Usage: Click "Send Request" above each ### section
### =====================================================

# --- ENVIRONMENT VARIABLES ---
@hostname = localhost:8081
@baseUrl = http://{{hostname}}

# --- AUTHENTICATION TOKENS (Update after login) ---
@token = eyJhbGciOiJIUzM4NCJ9.eyJzdWIiOiJtY3JkaWtAZ21haWwuY29tIiwiZW1wbG95ZWVJZCI6NDE0NiwiZW1wbG95ZWVDb2RlIjoiRU1QNjcxMzkiLCJ0aW1lem9uZSI6IkFzaWEvSmFrYXJ0YSIsImlhdCI6MTc1OTk5NzM3NywiZXhwIjoxNzYwMDgzNzc3fQ.AAUBfiMjbSdAk61JhBeIRm6Gp0GiHhT2XGhC2fHP4QOxAZfWzm1488MqI3zynZ6j

@adminToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...


@supervisorToken = eyJhbGciOiJIUzM4NCJ9.eyJzdWIiOiJzdXBlcnZpc29yQGhyaXMuY29tIiwiZW1wbG95ZWVJZCI6MywiZW1wbG95ZWVDb2RlIjoiU1VQMDAxIiwidGltZXpvbmUiOiJBc2lhL0pha2FydGEiLCJpYXQiOjE3NTk4MTQ5MTMsImV4cCI6MTc1OTkwMTMxM30.YEBEcCbl-jxymM9rb8g0q4C0iJWnFynENfyIdhZSynQT9k154cawMVIg8TCkp749
# --- DYNAMIC VARIABLES (Update after creating resources) ---
# Employee and Leave Type IDs are NUMERIC (1, 2, 3...)
# Leave Request, Attendance, Business Travel IDs are UUIDs for security
@employeeId = 1
@annualLeaveId = 1
@sickLeaveId = 2
@maternityLeaveId = 3
@attendanceUuid = 550e8400-e29b-41d4-a716-446655440000
@leaveRequestUuid = a7e230e5-a616-4352-8914-4bda5c170f93
@businessTravelUuid = 4d5d4101-6fbe-408e-b473-884b620d31e6
@passwordResetToken = your-reset-token-here

### =====================================================
### 1. AUTHENTICATION ENDPOINTS
### =====================================================

### @name loginEmployee
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "mcrdik@gmail.com",
  "password": "week123"
}

> {%
  if (response.status === 200) {
    client.global.set("token", response.body.data.token);
    client.log("‚úÖ Employee login successful!");
    client.log("Token: " + response.body.data.token);
    client.log("Employee: " + response.body.data.employee.firstName + " " + response.body.data.employee.lastName);
  } else {
    client.log("‚ùå Employee login failed: " + response.body.message);
  }
%}

### @name loginAdmin
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "admin@hris.com",
  "password": "admin123"
}

> {%
  if (response.status === 200) {
    client.global.set("adminToken", response.body.data.token);
    client.log("‚úÖ Admin login successful!");
    client.log("Token: " + response.body.data.token);
  } else {
    client.log("‚ùå Admin login failed: " + response.body.message);
  }
%}

### @name loginSupervisor
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "supervisor@hris.com",
  "password": "admin123"
}

> {%
  if (response.status === 200) {
    client.global.set("supervisorToken", response.body.data.token);
    client.log("‚úÖ Supervisor login successful!");
    client.log("Token: " + response.body.data.token);
  } else {
    client.log("‚ùå Supervisor login failed: " + response.body.message);
  }
%}

### @name getCurrentUser
GET {{baseUrl}}/api/auth/me
Authorization: Bearer {{token}}

### @name loginInvalidCredentials
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "invalid@hris.com",
  "password": "wrongpassword"
}

### @name loginInvalidFormat
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "invalid-email",
  "password": ""
}

### =====================================================
### 2. PASSWORD RESET ENDPOINTS
### =====================================================

### @name requestPasswordReset
POST {{baseUrl}}/api/auth/password-reset/forgot
Content-Type: application/json

{
  "email": "mcrdik@gmail.com"
}

> {%
  if (response.status === 200) {
    client.log("‚úÖ Password reset request sent successfully!");
    client.log("Response: " + response.body.message);
    client.log("üìß Check your email for the reset link");
    client.log("üîó Token will be valid for 1 hour");
  } else {
    client.log("‚ùå Password reset request failed: " + response.body.message);
  }
%}

### @name requestPasswordResetInvalidEmail
POST {{baseUrl}}/api/auth/password-reset/forgot
Content-Type: application/json

{
  "email": "nonexistent@example.com"
}

> {%
  if (response.status === 200) {
    client.log("‚úÖ Email enumeration protection working - returns success for invalid email");
  } else {
    client.log("‚ùå Unexpected response for invalid email: " + response.body.message);
  }
%}

### @name requestPasswordResetInvalidFormat
POST {{baseUrl}}/api/auth/password-reset/forgot
Content-Type: application/json

{
  "email": "invalid-email-format"
}

### @name verifyResetToken
GET {{baseUrl}}/api/auth/password-reset/verify-token?token={{passwordResetToken}}

### @name resetPasswordWithValidToken
POST {{baseUrl}}/api/auth/password-reset/reset
Content-Type: application/json

{
  "token": "{{passwordResetToken}}",
  "newPassword": "NewSecurePass123!",
  "confirmPassword": "NewSecurePass123!"
}

> {%
  if (response.status === 200) {
    client.log("‚úÖ Password reset successful!");
    client.log("Response: " + response.body.message);
  } else {
    client.log("‚ùå Password reset failed: " + response.body.message);
  }
%}

### @name resetPasswordWithWeakPassword
POST {{baseUrl}}/api/auth/password-reset/reset
Content-Type: application/json

{
  "token": "{{passwordResetToken}}",
  "newPassword": "weak",
  "confirmPassword": "weak"
}

### @name resetPasswordWithMismatch
POST {{baseUrl}}/api/auth/password-reset/reset
Content-Type: application/json

{
  "token": "{{passwordResetToken}}",
  "newPassword": "NewSecurePass123!",
  "confirmPassword": "DifferentPassword!"
}

### @name resetPasswordWithInvalidToken
POST {{baseUrl}}/api/auth/password-reset/reset
Content-Type: application/json

{
  "token": "invalid-or-expired-token",
  "newPassword": "NewSecurePass123!",
  "confirmPassword": "NewSecurePass123!"
}

### =====================================================
### 3. ATTENDANCE MANAGEMENT ENDPOINTS
### =====================================================

### @name clockIn
POST {{baseUrl}}/api/attendance/clock-in
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "latitude": -6.2088,
  "longitude": 106.8456,
  "faceImage": "base64-encoded-face-image-data",
  "notes": "Regular work day"
}

> {%
  if (response.status === 200) {
    client.global.set("attendanceUuid", response.body.data.uuid);
    client.log("‚úÖ Clock in successful!");
    client.log("Attendance UUID: " + response.body.data.uuid);
    client.log("Clock In Time: " + response.body.data.clockInTime);
  } else {
    client.log("‚ùå Clock in failed: " + response.body.message);
  }
%}

### @name clockInOutsideGeofence
POST {{baseUrl}}/api/attendance/clock-in
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "latitude": -6.3000,
  "longitude": 106.9000,
  "faceImage": "base64-encoded-face-image-data",
  "notes": "Working from client location"
}

### @name clockInTwice
POST {{baseUrl}}/api/attendance/clock-in
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "latitude": -6.2088,
  "longitude": 106.8456,
  "faceImage": "base64-encoded-face-image-data",
  "notes": "Second attempt - should fail"
}

### @name clockOut
POST {{baseUrl}}/api/attendance/clock-out
Authorization: Bearer {{token}}

> {%
  if (response.status === 200) {
    client.log("‚úÖ Clock out successful!");
    client.log("Total Hours: " + response.body.data.totalHours);
  } else {
    client.log("‚ùå Clock out failed: " + response.body.message);
  }
%}

### @name clockOutWithoutClockIn
POST {{baseUrl}}/api/attendance/clock-out
Authorization: Bearer {{token}}

### @name getTodayAttendance
GET {{baseUrl}}/api/attendance/today
Authorization: Bearer {{token}}

### @name getAttendanceStatus
GET {{baseUrl}}/api/attendance/status
Authorization: Bearer {{token}}

### @name getAttendanceHistory
GET {{baseUrl}}/api/attendance/history
Authorization: Bearer {{token}}

### @name getAttendanceHistoryPaginated
GET {{baseUrl}}/api/attendance/history?page=0&size=5
Authorization: Bearer {{token}}

### @name getAttendanceHistoryWithDateFilter
GET {{baseUrl}}/api/attendance/history?startDate=2025-01-01&endDate=2025-01-31
Authorization: Bearer {{token}}

### @name getAttendanceByUuid
GET {{baseUrl}}/api/attendance/{{attendanceUuid}}
Authorization: Bearer {{token}}

### @name getAttendanceByUuidAsSupervisor
GET {{baseUrl}}/api/attendance/{{attendanceUuid}}
Authorization: Bearer {{adminToken}}

### @name getNonExistentAttendanceByUuid
GET {{baseUrl}}/api/attendance/550e8400-e29b-41d4-a716-446655449999
Authorization: Bearer {{token}}

### =====================================================
### 4. LEAVE MANAGEMENT ENDPOINTS
### =====================================================

### @name submitAnnualLeave
POST {{baseUrl}}/api/leave/request
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "leaveTypeId": 1,
  "startDate": "2025-12-23",
  "endDate": "2025-12-23",
  "reason": "Family vacation - attending wedding ceremony"
}

> {%
  if (response.status === 201) {
    client.global.set("leaveRequestUuid", response.body.data.uuid);
    client.log("‚úÖ Leave request submitted!");
    client.log("UUID: " + response.body.data.uuid);
    client.log("Total Days: " + response.body.data.totalDays);
    client.log("Remaining Balance: " + response.body.data.remainingBalance);
  } else {
    client.log("‚ùå Leave request submission failed: " + response.body.message);
  }
%}

### @name submitSickLeave
POST {{baseUrl}}/api/leave/request
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "leaveTypeEnum": "SICK_LEAVE",
  "startDate": "2025-11-15",
  "endDate": "2025-11-15",
  "reason": "Medical appointment and recovery"
}

### @name submitMaternityLeave
POST {{baseUrl}}/api/leave/request
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "leaveTypeId": 5,
  "startDate": "2025-11-01",
  "endDate": "2025-11-03",
  "reason": "Maternity leave"
}

### @name submitLeaveWithInvalidDates
POST {{baseUrl}}/api/leave/request
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "leaveTypeEnum": "ANNUAL_LEAVE",
  "startDate": "2025-12-15",
  "endDate": "2025-12-10",
  "reason": "Invalid date range"
}

### @name submitLeaveWithPastDate
POST {{baseUrl}}/api/leave/request
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "leaveTypeEnum": "ANNUAL_LEAVE",
  "startDate": "2020-01-01",
  "endDate": "2020-01-02",
  "reason": "Past date"
}

### @name getMyLeaveRequests
GET {{baseUrl}}/api/leave/my-requests
Authorization: Bearer {{token}}

### @name getMyLeaveRequestsPaginated
GET {{baseUrl}}/api/leave/my-requests?page=0&size=5
Authorization: Bearer {{token}}

### @name getMyLeaveRequestsLast7Days
GET {{baseUrl}}/api/leave/my-requests?page=0&size=10&days=7
Authorization: Bearer {{token}}

### @name getMyLeaveRequestsLast90Days
GET {{baseUrl}}/api/leave/my-requests?days=90
Authorization: Bearer {{token}}

### @name getLeaveRequestByUuid
GET {{baseUrl}}/api/leave/request/{{leaveRequestUuid}}
Authorization: Bearer {{token}}

### @name getLeaveRequestByUuidAsSupervisor
GET {{baseUrl}}/api/leave/request/{{leaveRequestUuid}}
Authorization: Bearer {{supervisorToken}}

### @name getNonExistentLeaveRequestByUuid
GET {{baseUrl}}/api/leave/request/550e8400-e29b-41d4-a716-446655449999
Authorization: Bearer {{token}}

### @name getCurrentLeave
GET {{baseUrl}}/api/leave/current
Authorization: Bearer {{token}}

### @name approveLeaveRequest
POST {{baseUrl}}/api/leave/supervisor/approve/{{leaveRequestUuid}}
Authorization: Bearer {{supervisorToken}}

> {%
  if (response.status === 200) {
    client.log("‚úÖ Leave request approved!");
    client.log("Status: " + response.body.data.status);
  } else {
    client.log("‚ùå Leave approval failed: " + response.body.message);
  }
%}

### @name rejectLeaveRequest
POST {{baseUrl}}/api/leave/supervisor/reject/1428df48-0dc9-4d78-a2f7-a20aa14f4394
Authorization: Bearer {{supervisorToken}}

> {%
  if (response.status === 200) {
    client.log("‚úÖ Leave request rejected!");
    client.log("Status: " + response.body.data.status);
  } else {
    client.log("‚ùå Leave rejection failed: " + response.body.message);
  }
%}

### @name approveLeaveRequestAsEmployee
POST {{baseUrl}}/api/leave/supervisor/approve/{{leaveRequestUuid}}
Authorization: Bearer {{token}}

### @name rejectLeaveRequestWithoutReason
POST {{baseUrl}}/api/leave/supervisor/reject/{{leaveRequestUuid}}
Content-Type: application/json
Authorization: Bearer {{supervisorToken}}

> {%
  if (response.status === 400) {
    client.log("‚úÖ Rejection without reason properly rejected!");
    client.log("Error: " + response.body.message);
  } else {
    client.log("‚ùå Should have rejected empty reason");
  }
%}

### @name rejectLeaveRequestMissingReason
POST {{baseUrl}}/api/leave/supervisor/reject/{{leaveRequestUuid}}
Content-Type: application/json
Authorization: Bearer {{supervisorToken}}

{}

> {%
  if (response.status === 400) {
    client.log("‚úÖ Rejection with missing reason properly rejected!");
    client.log("Error: " + response.body.message);
  } else {
    client.log("‚ùå Should have rejected missing reason");
  }
%}

### @name getLeaveBalance
GET {{baseUrl}}/api/leave/balance
Authorization: Bearer {{token}}

### @name approveNonExistentLeaveRequest
POST {{baseUrl}}/api/leave/supervisor/approve/550e8400-e29b-41d4-a716-446655449999
Authorization: Bearer {{supervisorToken}}

> {%
  if (response.status === 409) {
    client.log("‚úÖ Non-existent leave request properly handled with 409 Conflict!");
    client.log("Error: " + response.body.message);
  } else {
    client.log("‚ùå Should return 409 for non-existent request, got: " + response.status);
  }
%}

### @name rejectNonExistentLeaveRequest
POST {{baseUrl}}/api/leave/supervisor/reject/550e8400-e29b-41d4-a716-446655449999
Authorization: Bearer {{supervisorToken}}

> {%
  if (response.status === 409) {
    client.log("‚úÖ Non-existent leave rejection properly handled with 409 Conflict!");
    client.log("Error: " + response.body.message);
  } else {
    client.log("‚ùå Should return 409 for non-existent request, got: " + response.status);
  }
%}

### =====================================================
### 4.1 LEAVE TYPES MANAGEMENT ENDPOINTS
### =====================================================

### @name getAllLeaveTypes
GET {{baseUrl}}/api/v1/leave-types
Authorization: Bearer {{token}}

> {%
  if (response.status === 200) {
    client.log("‚úÖ Leave types retrieved successfully!");
    client.log("Total leave types: " + response.body.length);
    if (response.body.length > 0) {
      client.log("Sample leave type: " + response.body[0].name + " (Code: " + response.body[0].code + ")");
      // Store leave type IDs for testing
      client.global.set("annualLeaveId", response.body.find(t => t.code === 'ANNUAL_LEAVE')?.id || 1);
      client.global.set("sickLeaveId", response.body.find(t => t.code === 'SICK_LEAVE')?.id || 2);
      client.global.set("maternityLeaveId", response.body.find(t => t.code === 'MATERNITY_LEAVE')?.id || 3);
    }
  } else {
    client.log("‚ùå Leave types retrieval failed: " + response.body.message);
  }
%}

### @name getLeaveTypeById
GET {{baseUrl}}/api/v1/leave-types/{{annualLeaveId}}
Authorization: Bearer {{token}}

### @name createLeaveType
POST {{baseUrl}}/api/v1/leave-types
Content-Type: application/json
Authorization: Bearer {{adminToken}}

{
  "code": "SPECIAL_LEAVE",
  "name": "Cuti Khusus",
  "description": "Cuti untuk keperluan khusus dengan persetujuan HR",
  "minDurationDays": 1,
  "maxDurationDays": 5,
  "hasBalanceQuota": false,
  "isPaidLeave": true,
  "requiresDocument": true,
  "isActive": true
}

> {%
  if (response.status === 200) {
    client.log("‚úÖ Leave type created successfully!");
    client.log("Name: " + response.body.name);
    client.log("Code: " + response.body.code);
    client.log("Has Balance Quota: " + response.body.hasBalanceQuota);
  } else {
    client.log("‚ùå Leave type creation failed: " + response.body.message);
  }
%}

### @name updateLeaveType
PUT {{baseUrl}}/api/v1/leave-types/{{annualLeaveId}}
Content-Type: application/json
Authorization: Bearer {{adminToken}}

{
  "code": "ANNUAL_LEAVE",
  "name": "Cuti Tahunan (Updated)",
  "description": "Cuti tahunan berbayar minimal 12 hari kerja sesuai UU Ketenagakerjaan",
  "minDurationDays": 12,
  "maxDurationDays": null,
  "hasBalanceQuota": true,
  "isPaidLeave": true,
  "requiresDocument": false,
  "isActive": true
}

### @name deactivateLeaveType
DELETE {{baseUrl}}/api/v1/leave-types/{{annualLeaveId}}
Authorization: Bearer {{adminToken}}

### =====================================================
### 4.2 LEAVE BALANCE MANAGEMENT ENDPOINTS
### =====================================================

### @name getMyLeaveBalances
GET {{baseUrl}}/api/v1/leave-balance/my-balances
Authorization: Bearer {{token}}

> {%
  if (response.status === 200) {
    client.log("‚úÖ My leave balances retrieved successfully!");
    client.log("Total leave types: " + response.body.length);
    response.body.forEach(function(balance) {
      if (balance.hasBalanceQuota) {
        client.log(balance.leaveTypeName + ": " + balance.remainingQuota + "/" + balance.totalQuota + " days (" + balance.percentageUsed + "% used)");
      } else {
        client.log(balance.leaveTypeName + ": No balance quota (transactional only)");
      }
    });
  } else {
    client.log("‚ùå Leave balances retrieval failed: " + response.body.message);
  }
%}

### @name getMySpecificLeaveBalance
GET {{baseUrl}}/api/v1/leave-balance/my-balances/leave-type/{{annualLeaveId}}
Authorization: Bearer {{token}}

> {%
  if (response.status === 200) {
    client.log("‚úÖ Specific leave balance retrieved!");
    client.log("Leave Type: " + response.body.leaveTypeName);
    client.log("Remaining: " + response.body.remainingQuota + "/" + response.body.totalQuota + " days");
    client.log("Percentage Used: " + response.body.percentageUsed + "%");
  } else {
    client.log("‚ùå Specific leave balance retrieval failed: " + response.body.message);
  }
%}

### @name getSubordinateLeaveBalances
GET {{baseUrl}}/api/v1/leave-balance/subordinates
Authorization: Bearer {{supervisorToken}}

> {%
  if (response.status === 200) {
    client.log("‚úÖ Subordinate leave balances retrieved!");
    client.log("Total records: " + response.body.length);
    response.body.forEach(function(balance) {
      client.log(balance.employeeName + " - " + balance.leaveTypeName + ": " + balance.remainingQuota + "/" + balance.totalQuota + " days");
    });
  } else {
    client.log("‚ùå Subordinate leave balances retrieval failed: " + response.body.message);
  }
%}

### @name getAllLeaveBalances
GET {{baseUrl}}/api/v1/leave-balance/all
Authorization: Bearer {{adminToken}}

> {%
  if (response.status === 200) {
    client.log("‚úÖ All leave balances retrieved (Manager/HR only)!");
    client.log("Total records: " + response.body.length);
  } else if (response.status === 403) {
    client.log("‚ùå Access denied - Manager/HR role required");
  } else {
    client.log("‚ùå All leave balances retrieval failed: " + response.body.message);
  }
%}

### @name getEmployeeLeaveBalancesById
GET {{baseUrl}}/api/v1/leave-balance/employee/{{employeeId}}
Authorization: Bearer {{supervisorToken}}

> {%
  if (response.status === 200) {
    client.log("‚úÖ Employee leave balances retrieved by supervisor!");
    client.log("Employee: " + response.body[0]?.employeeName);
    response.body.forEach(function(balance) {
      client.log(balance.leaveTypeName + ": " + balance.remainingQuota + "/" + balance.totalQuota + " days");
    });
  } else {
    client.log("‚ùå Employee leave balances retrieval failed: " + response.body.message);
  }
%}

### @name testLeaveBalanceAfterRequest
GET {{baseUrl}}/api/v1/leave-balance/my-balances/leave-type/{{annualLeaveId}}
Authorization: Bearer {{token}}

### =====================================================
### 4.3 HR QUOTA MANAGEMENT ENDPOINTS (NEW)
### =====================================================

### @name getMyHrQuota
GET {{baseUrl}}/api/v1/hr-quota/my-quota
Authorization: Bearer {{token}}

> {%
  if (response.status === 200) {
    client.log("‚úÖ My HR quota retrieved successfully!");
    client.log("Current Year: " + response.body.data.tahun);
    client.log("Annual Quota: " + response.body.data.cutiTahunan + " days");
    client.log("Used: " + response.body.data.cutiTahunanTerpakai + " days");
    client.log("Remaining: " + response.body.data.sisaCutiTahunan + " days");
  } else {
    client.log("‚ùå HR quota retrieval failed: " + response.body.message);
  }
%}

### @name getMyHrQuotaByYear
GET {{baseUrl}}/api/v1/hr-quota/my-quota?tahun=2025
Authorization: Bearer {{token}}

> {%
  if (response.status === 200) {
    client.log("‚úÖ My HR quota for 2025 retrieved!");
    client.log("Annual Quota: " + response.body.data.cutiTahunan + " days");
    client.log("Used: " + response.body.data.cutiTahunanTerpakai + " days");
    client.log("Remaining: " + response.body.data.sisaCutiTahunan + " days");
  } else {
    client.log("‚ùå HR quota by year retrieval failed: " + response.body.message);
  }
%}

### @name getHrQuotaByEmployeeId
GET {{baseUrl}}/api/v1/hr-quota/employee/{{employeeId}}?tahun=2025
Authorization: Bearer {{supervisorToken}}

> {%
  if (response.status === 200) {
    client.log("‚úÖ Employee HR quota retrieved by supervisor!");
    client.log("Employee ID: " + response.body.data.idEmployee);
    client.log("Year: " + response.body.data.tahun);
    client.log("Annual Quota: " + response.body.data.cutiTahunan + " days");
    client.log("Used: " + response.body.data.cutiTahunanTerpakai + " days");
    client.log("Remaining: " + response.body.data.sisaCutiTahunan + " days");
  } else {
    client.log("‚ùå Employee HR quota retrieval failed: " + response.body.message);
  }
%}

### @name getAllHrQuotasByYear
GET {{baseUrl}}/api/v1/hr-quota/all?tahun=2025
Authorization: Bearer {{adminToken}}

> {%
  if (response.status === 200) {
    client.log("‚úÖ All HR quotas for 2025 retrieved (Admin only)!");
    client.log("Total records: " + response.body.data.length);
    response.body.data.forEach(function(quota) {
      client.log("Employee " + quota.idEmployee + ": " + quota.sisaCutiTahunan + "/" + quota.cutiTahunan + " days remaining");
    });
  } else if (response.status === 403) {
    client.log("‚ùå Access denied - Admin role required");
  } else {
    client.log("‚ùå All HR quotas retrieval failed: " + response.body.message);
  }
%}

### @name createInitialHrQuota
POST {{baseUrl}}/api/v1/hr-quota/create
Content-Type: application/json
Authorization: Bearer {{adminToken}}

{
  "employeeId": {{employeeId}},
  "tahun": 2025,
  "initialQuota": 15
}

> {%
  if (response.status === 201) {
    client.log("‚úÖ Initial HR quota created successfully!");
    client.log("Employee ID: " + response.body.data.idEmployee);
    client.log("Year: " + response.body.data.tahun);
    client.log("Initial Quota: " + response.body.data.cutiTahunan + " days");
  } else {
    client.log("‚ùå HR quota creation failed: " + response.body.message);
  }
%}

### @name updateHrQuota
PUT {{baseUrl}}/api/v1/hr-quota/update/{{employeeId}}?tahun=2025
Content-Type: application/json
Authorization: Bearer {{adminToken}}

{
  "newQuota": 14
}

> {%
  if (response.status === 200) {
    client.log("‚úÖ HR quota updated successfully!");
    client.log("New Annual Quota: " + response.body.data.cutiTahunan + " days");
  } else {
    client.log("‚ùå HR quota update failed: " + response.body.message);
  }
%}

### @name deductHrQuota
POST {{baseUrl}}/api/v1/hr-quota/deduct/{{employeeId}}?tahun=2025
Content-Type: application/json
Authorization: Bearer {{adminToken}}

{
  "days": 3
}

> {%
  if (response.status === 200) {
    client.log("‚úÖ HR quota deducted successfully!");
    client.log("Days Deducted: 3");
    client.log("New Used Days: " + response.body.data.cutiTahunanTerpakai);
    client.log("New Remaining: " + response.body.data.sisaCutiTahunan);
  } else {
    client.log("‚ùå HR quota deduction failed: " + response.body.message);
  }
%}

### @name restoreHrQuota
POST {{baseUrl}}/api/v1/hr-quota/restore/{{employeeId}}?tahun=2025
Content-Type: application/json
Authorization: Bearer {{adminToken}}

{
  "days": 2
}

> {%
  if (response.status === 200) {
    client.log("‚úÖ HR quota restored successfully!");
    client.log("Days Restored: 2");
    client.log("New Used Days: " + response.body.data.cutiTahunanTerpakai);
    client.log("New Remaining: " + response.body.data.sisaCutiTahunan);
  } else {
    client.log("‚ùå HR quota restoration failed: " + response.body.message);
  }
%}

### @name resetAllHrQuotasByYear
POST {{baseUrl}}/api/v1/hr-quota/reset-all?tahun=2025
Content-Type: application/json
Authorization: Bearer {{adminToken}}

{
  "newQuota": 12
}

> {%
  if (response.status === 200) {
    client.log("‚úÖ All HR quotas for 2025 reset successfully!");
    client.log("Employees Updated: " + response.body.data.employeesUpdated);
    client.log("New Quota: " + response.body.data.newQuota + " days");
  } else {
    client.log("‚ùå HR quotas reset failed: " + response.body.message);
  }
%}

### @name getHrQuotaStatistics
GET {{baseUrl}}/api/v1/hr-quota/statistics?tahun=2025
Authorization: Bearer {{adminToken}}

> {%
  if (response.status === 200) {
    client.log("‚úÖ HR quota statistics for 2025 retrieved!");
    client.log("Total Employees: " + response.body.data.totalEmployees);
    client.log("Total Quota Allocated: " + response.body.data.totalQuota + " days");
    client.log("Total Quota Used: " + response.body.data.totalUsed + " days");
    client.log("Total Remaining: " + response.body.data.totalRemaining + " days");
    client.log("Usage Percentage: " + response.body.data.usagePercentage + "%");
  } else {
    client.log("‚ùå HR quota statistics retrieval failed: " + response.body.message);
  }
%}

### @name getHrQuotasWithNegativeBalance
GET {{baseUrl}}/api/v1/hr-quota/negative-balance?tahun=2025
Authorization: Bearer {{adminToken}}

> {%
  if (response.status === 200) {
    client.log("‚úÖ HR quotas with negative balance retrieved!");
    client.log("Total with negative balance: " + response.body.data.length);
    response.body.data.forEach(function(quota) {
      client.log("Employee " + quota.idEmployee + ": " + quota.sisaCutiTahunan + " days (negative)");
    });
  } else {
    client.log("‚ùå Negative balance quotas retrieval failed: " + response.body.message);
  }
%}

### @name testHrQuotaIntegration
GET {{baseUrl}}/api/v1/hr-quota/my-quota?tahun=2025
Authorization: Bearer {{token}}

> {%
  if (response.status === 200) {
    client.log("üîó HR QUOTA INTEGRATION TEST:");
    client.log("================================");
    client.log("‚úÖ hr_quota table integration working!");
    client.log("Employee Quota: " + response.body.data.cutiTahunan + " days");
    client.log("Used Days: " + response.body.data.cutiTahunanTerpakai + " days");
    client.log("Remaining: " + response.body.data.sisaCutiTahunan + " days");
    client.log("================================");
    client.log("This integrates with LeaveRequestService for automatic deduction");
  } else {
    client.log("‚ùå HR quota integration test failed: " + response.body.message);
  }
%}

### =====================================================
### 4.4 INDONESIAN REGULATION COMPLIANCE TESTS
### =====================================================

### @name submitAnnualLeaveIndonesia
POST {{baseUrl}}/api/leave/request
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "leaveTypeId": 1,
  "startDate": "2025-11-11",
  "endDate": "2025-11-16",
  "reason": "Cuti tahunan sesuai UU Ketenagakerjaan (12 hari minimal)"
}

> {%
  if (response.status === 201) {
    client.log("‚úÖ Annual leave (Indonesia compliant) submitted!");
    client.log("Total Days: " + response.body.data.totalDays);
    client.log("Remaining Balance: " + response.body.data.remainingBalance);
  } else {
    client.log("‚ùå Annual leave submission failed: " + response.body.message);
  }
%}

### @name submitMaternityLeaveIndonesia
POST {{baseUrl}}/api/leave/request
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "leaveTypeId": {{maternityLeaveId}},
  "startDate": "2025-12-01",
  "endDate": "2025-12-31",
  "reason": "Cuti melahirkan 1.5 bulan sebelum + 1.5 bulan sesudah melahirkan"
}

> {%
  if (response.status === 201) {
    client.log("‚úÖ Maternity leave (Indonesia compliant) submitted!");
    client.log("Total Days: " + response.body.data.totalDays);
    client.log("Leave Type: " + response.body.data.leaveType.name);
  } else {
    client.log("‚ùå Maternity leave submission failed: " + response.body.message);
  }
%}

### @name submitSickLeaveWithDocument
POST {{baseUrl}}/api/leave/request
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "leaveTypeId": {{sickLeaveId}},
  "startDate": "2025-11-15",
  "endDate": "2025-11-15",
  "reason": "Cuti sakit dengan surat keterangan dokter"
}

> {%
  if (response.status === 201) {
    client.log("‚úÖ Sick leave (with document requirement) submitted!");
    client.log("Balance before approval: " + response.body.data.remainingBalance);
  } else {
    client.log("‚ùå Sick leave submission failed: " + response.body.message);
  }
%}

### @name submitImportantReasonLeave
POST {{baseUrl}}/api/leave/request
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "leaveTypeEnum": "IMPORTANT_REASON_LEAVE",
  "startDate": "2025-11-20",
  "endDate": "2025-11-22",
  "reason": "Menikah - cuti alasan penting 3 hari"
}

> {%
  if (response.status === 201) {
    client.log("‚úÖ Important reason leave (marriage) submitted!");
    client.log("Note: This leave type has no balance quota (transactional only)");
  } else {
    client.log("‚ùå Important reason leave submission failed: " + response.body.message);
  }
%}

### @name submitMenstrualLeave
POST {{baseUrl}}/api/leave/request
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "leaveTypeEnum": "MENSTRUAL_LEAVE",
  "startDate": "2025-11-10",
  "endDate": "2025-11-11",
  "reason": "Cuti haid hari pertama dan kedua"
}

> {%
  if (response.status === 201) {
    client.log("‚úÖ Menstrual leave submitted!");
    client.log("Note: This leave type has no balance quota (transactional only)");
  } else {
    client.log("‚ùå Menstrual leave submission failed: " + response.body.message);
  }
%}

### @name submitCompassionateLeave
POST {{baseUrl}}/api/leave/request
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "leaveTypeEnum": "COMPASSIONATE_LEAVE",
  "startDate": "2025-11-05",
  "endDate": "2025-11-06",
  "reason": "Cuti belasungkawa - anggota keluarga meninggal"
}

> {%
  if (response.status === 201) {
    client.log("‚úÖ Compassionate leave submitted!");
    client.log("Note: This leave type has no balance quota (transactional only)");
  } else {
    client.log("‚ùå Compassionate leave submission failed: " + response.body.message);
  }
%}

### @name submitUnpaidLeave
POST {{baseUrl}}/api/leave/request
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "leaveTypeEnum": "UNPAID_LEAVE",
  "startDate": "2025-12-15",
  "endDate": "2025-12-20",
  "reason": "Cuti tidak berbayar untuk keperluan pribadi"
}

> {%
  if (response.status === 201) {
    client.log("‚úÖ Unpaid leave submitted!");
    client.log("Note: This leave type is not paid and has no balance quota");
  } else {
    client.log("‚ùå Unpaid leave submission failed: " + response.body.message);
  }
%}

### @name testBalanceQuotaDeduction
# This test demonstrates that only leave types with hasBalanceQuota=true deduct balance
GET {{baseUrl}}/api/v1/leave-balance/my-balances
Authorization: Bearer {{token}}

> {%
  if (response.status === 200) {
    client.log("üìä BALANCE QUOTA ANALYSIS:");
    client.log("================================");
    response.body.forEach(function(balance) {
      if (balance.hasBalanceQuota) {
        client.log("‚úèÔ∏è " + balance.leaveTypeName + ": " + balance.remainingQuota + "/" + balance.totalQuota + " days (REDUCES BALANCE)");
      } else {
        client.log("üìù " + balance.leaveTypeName + ": No balance quota (TRANSACTIONAL ONLY)");
      }
    });
    client.log("================================");
    client.log("Only Annual Leave & Sick Leave reduce balance quota");
    client.log("Other leave types are for transaction recording only");
  }
%}

### @name getPendingLeaveRequestsForSupervisor
GET {{baseUrl}}/api/leave/supervisor/pending
Authorization: Bearer {{supervisorToken}}

### =====================================================
### 5. BUSINESS TRAVEL MANAGEMENT ENDPOINTS
### =====================================================

### =====================================================
### 5.1 BUSINESS TRAVEL CITY DROPDOWN ENDPOINTS
### =====================================================

### @name getBusinessTravelCitiesDropdown
GET {{baseUrl}}/api/business-travel/cities
Authorization: Bearer {{token}}

> {%
  if (response.status === 200) {
    client.log("‚úÖ Business travel cities dropdown retrieved successfully!");
    client.log("Total cities: " + response.body.data.length);
    if (response.body.data.length > 0) {
      client.log("Sample city: " + response.body.data[0].displayText);
      client.global.set("businessTravelCityId", response.body.data[0].id);
    }
  } else {
    client.log("‚ùå Business travel cities dropdown retrieval failed: " + response.body.message);
  }
%}

### @name searchBusinessTravelCities
GET {{baseUrl}}/api/business-travel/cities?search=Jakarta
Authorization: Bearer {{token}}

> {%
  if (response.status === 200) {
    client.log("‚úÖ Business travel city search completed!");
    client.log("Found cities: " + response.body.data.length);
    if (response.body.data.length > 0) {
      client.log("Search results: " + JSON.stringify(response.body.data));
    }
  } else {
    client.log("‚ùå Business travel city search failed: " + response.body.message);
  }
%}

### @name searchBusinessTravelCitiesByProvince
GET {{baseUrl}}/api/business-travel/cities?page=0&size=37
Authorization: Bearer {{token}}

> {%
  if (response.status === 200) {
    client.log("‚úÖ Business travel cities by province search completed!");
    client.log("Found cities in Jawa: " + response.body.data.length);
  } else {
    client.log("‚ùå Business travel cities by province search failed: " + response.body.message);
  }
%}

### @name getBusinessTravelCitiesDropdownUnauthorized
GET {{baseUrl}}/api/business-travel/cities

### @name getBusinessTravelCitiesDropdownInvalidToken
GET {{baseUrl}}/api/business-travel/cities
Authorization: Bearer invalid-token-here

### =====================================================
### 5.2 GENERAL CITY MANAGEMENT ENDPOINTS
### =====================================================

### @name getAllCitiesForDropdown
GET {{baseUrl}}/api/cities/dropdown

> {%
  if (response.status === 200) {
    client.log("‚úÖ Cities dropdown retrieved successfully!");
    client.log("Total cities: " + response.body.data.length);
    if (response.body.data.length > 0) {
      client.log("Sample city: " + response.body.data[0].displayName);
      client.global.set("cityId", response.body.data[0].id);
    }
  } else {
    client.log("‚ùå Cities dropdown retrieval failed: " + response.body.message);
  }
%}

### @name searchCities
GET {{baseUrl}}/api/cities/dropdown?search=Jakarta

> {%
  if (response.status === 200) {
    client.log("‚úÖ City search completed!");
    client.log("Found cities: " + response.body.data.length);
  } else {
    client.log("‚ùå City search failed: " + response.body.message);
  }
%}

### @name getCitiesByProvince
GET {{baseUrl}}/api/cities/dropdown?province=Jawa Barat

> {%
  if (response.status === 200) {
    client.log("‚úÖ Cities by province retrieved!");
    client.log("Cities in Jawa Barat: " + response.body.data.length);
  } else {
    client.log("‚ùå Cities by province retrieval failed: " + response.body.message);
  }
%}

### @name getAllCitiesPaginated
GET {{baseUrl}}/api/cities?page=0&size=5

> {%
  if (response.status === 200) {
    client.log("‚úÖ Paginated cities retrieved!");
    client.log("Current page: " + response.body.data.currentPage);
    client.log("Total elements: " + response.body.data.totalElements);
  } else {
    client.log("‚ùå Paginated cities retrieval failed: " + response.body.message);
  }
%}

### @name getCityById
GET {{baseUrl}}/api/cities/{{cityId}}

### =====================================================
### 5.3 BUSINESS TRAVEL REQUEST ENDPOINTS
### =====================================================

### @name submitBusinessTravelRequest
POST {{baseUrl}}/api/business-travel/request
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "cityId": 1,
  "startDate": "2025-11-12",
  "endDate": "2025-11-13",
  "reason": "Client meeting and project discussion"
}

> {%
  if (response.status === 201) {
    client.global.set("businessTravelUuid", response.body.data.uuid);
    client.log("‚úÖ Business travel request submitted!");
    client.log("UUID: " + response.body.data.uuid);
    client.log("Total Days: " + response.body.data.totalDays);
    client.log("City: " + response.body.data.cityDisplayName);
  } else {
    client.log("‚ùå Business travel request submission failed: " + response.body.message);
  }
%}

### @name submitBusinessTravelShortTrip
POST {{baseUrl}}/api/business-travel/request
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "cityId": 2,
  "startDate": "2025-11-20",
  "endDate": "2025-11-20",
  "reason": "One-day business meeting"
}

### @name submitBusinessTravelLongTrip
POST {{baseUrl}}/api/business-travel/request
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "cityId": 3,
  "startDate": "2025-12-01",
  "endDate": "2025-12-05",
  "reason": "Conference and networking"
}

### @name submitBusinessTravelWithInvalidDates
POST {{baseUrl}}/api/business-travel/request
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "cityId": 1,
  "startDate": "2025-12-15",
  "endDate": "2025-12-10",
  "reason": "Invalid date range"
}

### @name submitBusinessTravelWithInvalidCity
POST {{baseUrl}}/api/business-travel/request
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "cityId": 8,
  "startDate": "2025-12-20",
  "endDate": "2025-12-22",
  "reason": "Testing invalid city"
}

### @name getMyBusinessTravelRequests
GET {{baseUrl}}/api/business-travel/my-requests
Authorization: Bearer {{token}}

### @name getMyBusinessTravelRequestsPaginated
GET {{baseUrl}}/api/business-travel/my-requests?page=0&size=5
Authorization: Bearer {{token}}

### @name getBusinessTravelRequestByUuid
GET {{baseUrl}}/api/business-travel/request/{{businessTravelUuid}}
Authorization: Bearer {{token}}

### @name getBusinessTravelRequestByUuidAsSupervisor
GET {{baseUrl}}/api/business-travel/request/{{businessTravelUuid}}
Authorization: Bearer {{supervisorToken}}

### @name getNonExistentBusinessTravelRequestByUuid
GET {{baseUrl}}/api/business-travel/request/4d5d4101-6fbe-408e-b473-884b620d31e6
Authorization: Bearer {{token}}

### @name getCurrentBusinessTravel
GET {{baseUrl}}/api/business-travel/current
Authorization: Bearer {{token}}

### @name getPendingBusinessTravelRequestsForSupervisor
GET {{baseUrl}}/api/business-travel/supervisor/pending
Authorization: Bearer {{supervisorToken}}

### @name approveBusinessTravelRequest
POST {{baseUrl}}/api/business-travel/supervisor/approve/{{businessTravelUuid}}
Authorization: Bearer {{supervisorToken}}

> {%
  if (response.status === 200) {
    client.log("‚úÖ Business travel request approved!");
    client.log("Status: " + response.body.data.status);
  } else {
    client.log("‚ùå Business travel approval failed: " + response.body.message);
  }
%}

### @name rejectBusinessTravelRequest
POST {{baseUrl}}/api/business-travel/supervisor/reject/8b4cbaa5-8561-4a38-9625-dc86cb1f6fdb
Authorization: Bearer {{supervisorToken}}

> {%
  if (response.status === 200) {
    client.log("‚úÖ Business travel request rejected!");
    client.log("Status: " + response.body.data.status);
  } else {
    client.log("‚ùå Business travel rejection failed: " + response.body.message);
  }
%}

### @name approveBusinessTravelRequestAsEmployee
POST {{baseUrl}}/api/business-travel/supervisor/approve/{{businessTravelUuid}}
Authorization: Bearer {{token}}

### =====================================================
### 6. HR ADMIN ENDPOINTS (ADMIN/HR roles only)
### =====================================================

### @name registerNewEmployee
POST {{baseUrl}}/api/admin/register-employee
Content-Type: application/json
Authorization: Bearer {{adminToken}}

{
  "firstName": "John",
  "lastName": "Doe",
  "email": "john.doe@company.com",
  "password": "TempPass123",
  "employeeId": "EMP123",
  "role": "EMPLOYEE",
  "supervisorId": 2
}

> {%
  if (response.status === 200) {
    client.global.set("employeeId", response.body.data.id);
    client.log("‚úÖ Employee registered! ID: " + response.body.data.id);
  } else {
    client.log("‚ùå Employee registration failed: " + response.body.message);
  }
%}

### @name registerSupervisor
POST {{baseUrl}}/api/admin/register-employee
Content-Type: application/json
Authorization: Bearer {{adminToken}}

{
  "firstName": "Jane",
  "lastName": "Smith",
  "email": "jane.smith@company.com",
  "password": "TempPass123",
  "employeeId": "SUP123",
  "role": "SUPERVISOR"
}

### @name registerEmployeeWithInvalidData
POST {{baseUrl}}/api/admin/register-employee
Content-Type: application/json
Authorization: Bearer {{adminToken}}

{
  "firstName": "",
  "lastName": "",
  "email": "invalid-email",
  "password": "123",
  "employeeId": "",
  "role": "INVALID_ROLE"
}

### @name getAllEmployees
GET {{baseUrl}}/api/admin/employees
Authorization: Bearer {{adminToken}}

### @name getAllEmployeesPaginated
GET {{baseUrl}}/api/admin/employees?page=0&size=5
Authorization: Bearer {{adminToken}}

### @name searchEmployees
GET {{baseUrl}}/api/admin/employees?search=john&role=EMPLOYEE&active=true
Authorization: Bearer {{adminToken}}

### @name getEmployeeById
GET {{baseUrl}}/api/admin/employees/{{employeeId}}
Authorization: Bearer {{adminToken}}

### @name updateEmployee
PUT {{baseUrl}}/api/admin/employees/{{employeeId}}
Content-Type: application/json
Authorization: Bearer {{adminToken}}

{
  "firstName": "John Updated",
  "lastName": "Doe Updated",
  "email": "john.doe.updated@company.com",
  "role": "SUPERVISOR"
}

### @name updateEmployeeWithInvalidData
PUT {{baseUrl}}/api/admin/employees/{{employeeId}}
Content-Type: application/json
Authorization: Bearer {{adminToken}}

{
  "firstName": "",
  "email": "invalid-email",
  "role": "INVALID_ROLE"
}

### @name deactivateEmployee
POST {{baseUrl}}/api/admin/employees/{{employeeId}}/deactivate
Authorization: Bearer {{adminToken}}

### @name updateFaceTemplate
POST {{baseUrl}}/api/admin/employees/{{employeeId}}/face-template
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW
Authorization: Bearer {{adminToken}}

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="faceImage"; filename="face.jpg"
Content-Type: image/jpeg

< ./face-template.jpg
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### =====================================================
### 7. DATA MIGRATION ENDPOINTS (ADMIN role only)
### =====================================================

### @name initializeDefaultData
POST {{baseUrl}}/api/migration/initialize
Authorization: Bearer {{adminToken}}

> {%
  if (response.status === 200) {
    client.log("‚úÖ Default data initialized successfully!");
    client.log("Roles created: " + response.body.data.rolesCreated);
    client.log("Admin user created: " + response.body.data.adminUserCreated);
  } else {
    client.log("‚ùå Data initialization failed: " + response.body.message);
  }
%}

### @name importEmployeesFromCSV
POST {{baseUrl}}/api/migration/import-employees
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW
Authorization: Bearer {{adminToken}}

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="file"; filename="employees.csv"
Content-Type: text/csv

firstName,lastName,email,employeeId,role,supervisorId
John,Doe,john.doe@company.com,EMP004,EMPLOYEE,2
Jane,Smith,jane.smith@company.com,EMP005,EMPLOYEE,2
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### @name getCSVTemplate
GET {{baseUrl}}/api/migration/csv-template
Authorization: Bearer {{adminToken}}

### =====================================================
### 8. SYSTEM HEALTH & MONITORING ENDPOINTS
### =====================================================

### @name testEmailService
GET {{baseUrl}}/api/test/email?to=test@example.com
Authorization: Bearer {{adminToken}}

### @name getApplicationHealth
GET {{baseUrl}}/actuator/health

### @name getApplicationInfo
GET {{baseUrl}}/actuator/info

### =====================================================
### 9. DEVELOPMENT & DEBUGGING ENDPOINTS
### =====================================================

### @name generatePasswordHash
GET {{baseUrl}}/api/auth/debug/hash?password=testpassword123
Authorization: Bearer {{adminToken}}

### @name verifyPassword
POST {{baseUrl}}/api/auth/debug/verify
Content-Type: application/json
Authorization: Bearer {{adminToken}}

{
  "password": "testpassword123",
  "hashedPassword": "$2a$10$..."
}

### =====================================================
### 10. ERROR HANDLING & SECURITY TESTS
### =====================================================

### @name unauthorizedAccess
GET {{baseUrl}}/api/admin/employees

### @name invalidToken
GET {{baseUrl}}/api/attendance/history
Authorization: Bearer invalid-token-here

### @name expiredToken
GET {{baseUrl}}/api/attendance/history
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJleHBpcmVkIiwiaWF0IjoxNjAwMDAwMDAwLCJleHAiOjE2MDAwMDAwMDF9.invalid

### @name forbiddenAccess
GET {{baseUrl}}/api/admin/employees
Authorization: Bearer {{token}}

### @name rateLimitingTestLogin
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "test@hris.com",
  "password": "wrongpassword"
}

### @name rateLimitingTestPasswordReset
POST {{baseUrl}}/api/auth/password-reset/forgot
Content-Type: application/json

{
  "email": "test@hris.com"
}

### =====================================================
### 11. AUTHORIZATION TESTS
### =====================================================

### @name employeeAccessAdminEndpoint
GET {{baseUrl}}/api/admin/employees
Authorization: Bearer {{token}}

### @name supervisorAccessAdminEndpoint
GET {{baseUrl}}/api/admin/employees
Authorization: Bearer {{supervisorToken}}

### @name employeeAccessSupervisorEndpoint
GET {{baseUrl}}/api/leave/supervisor/pending
Authorization: Bearer {{supervisorToken}}

### @name adminAccessAllEndpoints
GET {{baseUrl}}/api/leave/supervisor/pending
Authorization: Bearer {{adminToken}}

### =====================================================
### 12. VALIDATION TESTS
### =====================================================

### @name submitLeaveRequestWithEmptyFields
POST {{baseUrl}}/api/leave/request
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "leaveType": "",
  "startDate": "",
  "endDate": "",
  "reason": ""
}

### @name submitBusinessTravelWithEmptyFields
POST {{baseUrl}}/api/business-travel/request
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "cityId": null,
  "startDate": "",
  "endDate": "",
  "reason": ""
}

### @name clockInWithInvalidCoordinates
POST {{baseUrl}}/api/attendance/clock-in
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "latitude": "invalid",
  "longitude": "invalid",
  "faceImage": "",
  "notes": ""
}

### =====================================================
### TESTING INSTRUCTIONS & WORKFLOWS
### =====================================================

# --- QUICK START ---
# 1. Start the application: mvn spring-boot:run -Dspring-boot.run.profiles=dev
# 2. Initialize data: Run "initializeDefaultData" request
# 3. Login: Run "loginAdmin", "loginSupervisor", and "loginEmployee" requests
# 4. Update tokens: Copy tokens from responses to @token, @adminToken, @supervisorToken variables
# 5. Test workflows: Follow the numbered testing sequences below

# --- WORKFLOW 1: COMPLETE EMPLOYEE DAILY WORKFLOW ---
# 1. loginEmployee ‚Üí clockIn ‚Üí getTodayAttendance ‚Üí clockOut ‚Üí getAttendanceHistory
# 2. getAllLeaveTypes ‚Üí submitAnnualLeave ‚Üí getMyLeaveRequests ‚Üí getMyLeaveBalances ‚Üí getCurrentLeave
# 3. getBusinessTravelCitiesDropdown ‚Üí submitBusinessTravelRequest ‚Üí getMyBusinessTravelRequests ‚Üí getCurrentBusinessTravel

# --- WORKFLOW 2: ENHANCED LEAVE MANAGEMENT WORKFLOW ---
# 1. getAllLeaveTypes ‚Üí test Indonesian regulation compliance
# 2. submitAnnualLeaveIndonesia ‚Üí submitMaternityLeaveIndonesia ‚Üí submitSickLeaveWithDocument
# 3. submitImportantReasonLeave ‚Üí submitMenstrualLeave ‚Üí submitCompassionateLeave ‚Üí submitUnpaidLeave
# 4. testBalanceQuotaDeduction ‚Üí getMyLeaveBalances ‚Üí verify balance behavior
# 5. getMyHrQuota ‚Üí testHrQuotaIntegration ‚Üí verify hr_quota table functionality

# --- WORKFLOW 3: SUPERVISOR APPROVAL WORKFLOW ---
# 1. loginSupervisor ‚Üí getPendingLeaveRequests ‚Üí approveLeaveRequest
# 2. getSubordinateLeaveBalances ‚Üí monitor team leave quotas
# 3. getPendingBusinessTravelRequests ‚Üí approveBusinessTravelRequest
# 4. Test rejection workflow: rejectLeaveRequest (with rejectionReason) and rejectBusinessTravelRequest
# 5. Test rejection validation: rejectLeaveRequestWithoutReason, rejectLeaveRequestMissingReason
# 6. Test non-existent requests: approveNonExistentLeaveRequest, rejectNonExistentLeaveRequest

# --- WORKFLOW 4: HR ADMIN MANAGEMENT WORKFLOW ---
# 1. loginAdmin ‚Üí registerNewEmployee ‚Üí getAllEmployees ‚Üí updateEmployee
# 2. createLeaveType ‚Üí updateLeaveType ‚Üí getAllLeaveTypes ‚Üí deactivateLeaveType
# 3. getAllLeaveBalances ‚Üí monitor organization-wide leave usage
# 4. getEmployeeById ‚Üí deactivateEmployee ‚Üí updateFaceTemplate
# 5. createInitialHrQuota ‚Üí updateHrQuota ‚Üí getHrQuotaStatistics ‚Üí resetAllHrQuotasByYear
# 6. Test pagination and search functionality

# --- WORKFLOW 5: PASSWORD RESET WORKFLOW ---
# 1. requestPasswordReset ‚Üí checkEmail ‚Üí verifyResetToken ‚Üí resetPasswordWithValidToken
# 2. Test with new password: loginEmployee
# 3. Test security: requestPasswordResetInvalidEmail, resetPasswordWithWeakPassword

# --- WORKFLOW 6: SECURITY & ERROR HANDLING ---
# 1. Test unauthorized access: employeeAccessAdminEndpoint
# 2. Test invalid tokens: invalidToken, expiredToken
# 3. Test validation: submitLeaveRequestWithEmptyFields
# 4. Test business rules: clockInTwice, submitLeaveWithInvalidDates

# --- TESTING BEST PRACTICES ---
# 1. Always update tokens after successful login
# 2. Update UUID variables after creating resources (Leave requests use UUIDs)
# 3. Update ID variables for leave types (Leave types use numeric IDs)
# 4. Test both success and failure scenarios
# 5. Verify response formats and status codes
# 6. Check console logs for debugging information
# 7. Test role-based access control thoroughly
# 8. Validate input handling and error messages
# 9. Test pagination and filtering parameters

# --- RESPONSE FORMAT EXPECTATIONS ---
# Success: {"success": true, "message": "...", "data": {...}}
# Error: {"success": false, "message": "...", "error": "ERROR_TYPE"}
# Paginated: {"success": true, "data": {"content": [...], "totalElements": N, "totalPages": N, "currentPage": N}}
# --- ID SYSTEM ARCHITECTURE ---
# Mixed ID Approach for Security & Performance:
# - Leave Types: Numeric IDs (1, 2, 3...) for database efficiency and simplicity
# - Leave Requests: UUIDs for security (prevents IDOR attacks)
# - Employees: Numeric IDs for internal references
# - Attendance: UUIDs for security and audit trail
# - Business Travel: UUIDs for security and tracking

# --- NEW LEAVE MANAGEMENT API RESPONSES ---
# Leave Types: [{"id": 1, "code": "ANNUAL_LEAVE", "name": "Cuti Tahunan", "hasBalanceQuota": true}]
# Leave Balances: [{"employeeName": "...", "leaveTypeName": "...", "remainingQuota": 10, "totalQuota": 12, "percentageUsed": 16.67}]
# Leave Requests: {"uuid": "...", "leaveType": {"id": 1, "name": "Cuti Tahunan"}, "remainingBalance": 10}
# HR Quotas: {"id": 1, "idEmployee": 1, "tahun": 2025, "cutiTahunan": 12, "cutiTahunanTerpakai": 3, "sisaCutiTahunan": 9}

# --- UPDATED STATUS CODES ---
# Create requests: 201 Created (POST /api/leave/request, POST /api/business-travel/request)
# Get requests: 200 OK (GET endpoints)
# Update requests: 200 OK (PUT/PATCH endpoints)
# Delete requests: 200 OK (DELETE endpoints)
# Validation errors: 400 Bad Request
# Authentication errors: 401 Unauthorized
# Authorization errors: 403 Forbidden
# Not found: 404 Not Found
# Business logic conflicts: 409 Conflict (e.g., approving non-existent leave request)

# --- LEAVE REJECTION API UPDATES ---
# Rejection endpoint now requires: {"rejectionReason": "Valid reason text"}
# Empty/null rejection reason returns: 400 Bad Request
# Rejection reason validation: Must not be empty or whitespace only

# --- SECURITY NOTES ---
# - UUIDs prevent IDOR attacks (Insecure Direct Object Reference)
# - Role-based access control enforced on all endpoints
# - Password reset includes email enumeration protection
# - Rate limiting prevents brute force attacks
# - All sensitive endpoints require proper authentication
# - Leave balance access controlled by role (Employee, Supervisor, Manager/HR)
# - Leave type management restricted to Admin/HR roles only
# - HR quota management restricted to Admin/HR roles for create/update/delete operations
# - Employees can only view their own HR quota; supervisors can view subordinates' quotas

### =====================================================
### END OF COMPREHENSIVE API TESTING SUITE
### =====================================================